> 慕课网<<Web安全-XSS>>课程笔记

## Web安全之模拟XSS攻击
**理解XSS的攻击方式**
- 反射型
> 发出请求是,XSS代码出现在URL中,作为输入提交到服务器端,服务器端解析后响应,XSS代码随着响应内容一起传回浏览器,最后浏览器解析执行XSS代码。这个过程像一次反射,故叫做反射型XSS。
- 存储型
> 存储型XSS和反射型XSS的差别在于,提交的代码会存储在服务器中(例如数据库,内存,文件系统等),下次请求页面是不用再提交XSS代码。

## 防范措施
### 过滤
- 移除用户上传的DOM属性，如onclick,onerror等
- 移除用户上传的style、a,script、iframe节点等
### 校正
- 避免直接对HTML Entity解码
- 使用DOM Parse转换，校正不配对的DOM标签

## 实验注意点
- routes/index.js需要res.set('X-XSS-Protection',0)，否则Chrome浏览器自带脚本拦截，使攻击不生效
- Chrome浏览器无法发送脚本,要用其他浏览器发送脚本

## CSRF 跨站点请求伪造（Cross-site request forgery）
> 你已经登录了A，浏览器存有了A网站服务器下发的cookie。
你现在登录B网站，B网站中有一个指向A网站服务器的链接引诱你去点击了。
如果A网站的服务器只有cookie验证，那么B网站已经拥有你在A网站的访问权限了。
- 防范措施：增加除了cookie以外的其他验证
    - Token验证(url中存放令牌) 
    - Http请求头添加Referer验证:如果服务器检测到referer字段不是自己的前端网站，则可以判断到是攻击者
    - 隐藏令牌(请求头中存放令牌)

## 两种攻击的区别
- CSRF利用本身的漏洞来调用接口(骗过登录验证)